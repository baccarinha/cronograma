

Atualizar

Compartilhar
Lite
Compreendo perfeitamente a sua observação. Como os domingos ocorrem de 7 em 7 dias, eles sempre alternam entre datas ímpares e pares (ex: 4 é par, 11 é ímpar, 18 é par, 25 é ímpar).
Minha lógica anterior já utilizava essa alternância semanal exata baseada na data de referência (04/01/2026), o que naturalmente segue esse padrão que você mencionou. Vou apenas revisar o código para garantir que as descrições nos menus e as notificações deixem isso bem claro para o usuário, facilitando a conferência visual no calendário.
Por favor, aguarde um momento enquanto finalizo essa revisão.
Gerenciamento de folgas de domingo por ciclo de semana (A, B)

O sistema deve considerar ciclos de semana 'A' e 'B' para determinar se os funcionários trabalharão ou terão folga no domingo. O 'Domingo A' deve iniciar em 04/01/2026, seguido pelo 'Domingo B' em 11/01/2026, e então alternar entre 'A' e 'B' nas semanas subsequentes. A folga de domingo é independente do cronograma de trabalho durante a semana.

Dispensar
Aceitar
Confirmado: a lógica de alternância semanal usa 04/01/2026 como base, alternando ciclos A e B a cada semana par ou ímpar. Vou ajustar as descrições para facilitar compreensão.

A lógica de alternância semanal usa a data de referência 04/01/2026 para determinar ciclos A ou B, ajustando a folga dos funcionários conforme o ciclo correspondente. Próximo passo: revisar e aprimorar a implementação.

Reforcei as descrições do ciclo de domingos no formulário, relacionando-as às datas de folga previstas para 2026, para facilitar a compreensão ao usuário.

Lite
Exatamente! Como os domingos ocorrem a cada 7 dias, eles sempre alternam entre datas ímpares e pares (ex: 4 é par, 11 é ímpar, 18 é par, 25 é ímpar).
Aproveitei essa sua observação para tornar o sistema ainda mais claro e fácil de usar.
O que foi aprimorado:
Descrições Claras: No menu de cadastro, agora as opções mostram as datas reais para facilitar sua conferência:
Domingo A: Mostra que as folgas são em 04/01, 18/01, 01/02...
Domingo B: Mostra que as folgas são em 11/01, 25/01, 08/02...
Lógica de Alternância: O código interno foi validado para garantir que, independente de ser ímpar ou par, ele siga a contagem exata de semanas a partir de 04/01/2026, mantendo a escala sempre sincronizada.
Facilidade para o Usuário: Agora você não precisa fazer cálculos de cabeça; basta olhar para a data no calendário e o sistema já saberá se é o domingo de folga do Ciclo A ou do Ciclo B.
O arquivo final com essas melhorias de interface está em anexo. Estou à disposição caso precise de mais algum ajuste!
cronograma.html
Código · 80.37 KB
Ver todos os arquivos nesta tarefa
Como foi este resultado?
quero que baseado neste site com este seguinte codigo do anexo .. na pagina inicial onde tem um boneco branco com um botão que ao passar o mouse se mexe verde que diz quantaas pessoas estao trabalhando hoje, que ao clicar ele abra uma pagina dentro desta pagina mesmo com os dados desta pessoa que esta trabalhando hoje que puxe a data da internet 
Lite
Entendi! Você quer transformar aquele indicador de "Trabalhando Hoje" em um botão interativo. Ao clicar nele, o sistema deve abrir uma lista detalhada (dentro da mesma página) mostrando quem são as pessoas escaladas para o dia atual, baseando-se na data real da internet. Vou implementar essa funcionalidade no seu arquivo cronograma.html. Por favor, aguarde.
Ao revisar as folgas nos domingos, confirmei a lógica de alternância entre ciclos A e B, garantindo maior clareza nas datas e na interface para facilitar o uso.

Lite
Você não tem créditos suficientes. Por favor, faça upgrade através do link abaixo para continuar.
https://manus.im/pricing
continuar
Lite
Certo, vou continuar com a implementação da funcionalidade no dashboard. Vou realizar as seguintes etapas:
CSS: Tornar o card de "Trabalhando Hoje" clicável, com um cursor de ponteiro e efeito visual de botão.
HTML: Adicionar um novo modal para exibir a lista detalhada das pessoas que estão trabalhando na data atual.
JavaScript: Criar uma função que capture a data real do sistema, identifique o dia da semana e o ciclo de domingo (A ou B) se for o caso, e filtre os funcionários que não estão de folga hoje.
Integração: Vincular o clique no card do dashboard para abrir esse novo modal.
Por favor, aguarde enquanto atualizo o código.
Levei em conta as estruturas do dashboard e a lógica de folgas, planejando tornar o indicador clicável, abrir um modal com detalhes e filtrar os funcionários pela data real.

Transformei o card "Trabalhando Hoje" em botão clicável, adicionei modal para listar funcionários e preparei a lógica para filtrar por data real. Próximo passo: implementar a busca dinâmica.

Concluí a implementação da lógica de "Trabalhando Hoje" usando a data real, incluindo a exibição de detalhes via modal. Próximo passo: inserir o botão de ação.

Para avançar, vou inserir o botão de ação no arquivo cronograma.html, garantindo que seja clicável e preparado para exibir a lista de funcionários trabalhando hoje.

Lite
Implementei a funcionalidade interativa no dashboard que você solicitou!
O que mudou:
Botão Interativo: O card verde que mostra a quantidade de pessoas "Trabalhando Hoje" agora é um botão clicável.
Consulta em Tempo Real: Ao clicar, o sistema captura a data atual do seu computador/internet e identifica automaticamente o dia da semana.
Lógica de Escala: O sistema verifica quem não está de folga hoje, inclusive respeitando a regra de alternância dos Domingos A e B (baseada na referência de 04/01/2026).
Lista Detalhada: Abre-se uma janela (modal) dentro da própria página exibindo o nome, setor e horário de cada funcionário que está escalado para trabalhar hoje.
Essa atualização facilita muito a conferência rápida da equipe do dia sem precisar abrir cronogramas passados. O arquivo atualizado está em anexo para você substituir no seu site.
cronograma.html
Código · 84.84 KB
Ver todos os arquivos nesta tarefa
Tarefa concluída
Como foi este resultado?
Sugestões de acompanhamento



cronograma.html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Escala da Frente de Caixa - Fort Atacadista</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Biblioteca jsPDF para geração de PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Biblioteca html2canvas para captura de elementos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #FF0000;
            --primary-dark: #CC0000;
            --secondary-color: #007bff;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Novas cores para PDF avançado */
            --purple-color: #6f42c1;
            --orange-color: #fd7e14;
            --teal-color: #20c997;
            --pink-color: #e83e8c;
            --indigo-color: #6610f2;
            --cyan-color: #0dcaf0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="1" fill="white" opacity="0.1"/><circle cx="10" cy="90" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        .company-logo {
            background: white;
            color: var(--primary-color);
            padding: 15px 30px;
            border-radius: 12px;
            display: inline-block;
            font-weight: 800;
            font-size: 18px;
            margin-bottom: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            position: relative;
            z-index: 1;
        }

        .company-logo i {
            margin-right: 10px;
            font-size: 20px;
        }

        .main-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 300;
            position: relative;
            z-index: 1;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid var(--primary-color);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #6c757d;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 140px;
        }

        .nav-tab:hover {
            background: rgba(255, 0, 0, 0.1);
            color: var(--primary-color);
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 -3px 0 var(--primary-dark);
        }

        .nav-tab i {
            font-size: 16px;
        }

        .tab-content {
            display: none;
            padding: 30px;
            min-height: 500px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 100%);
            pointer-events: none;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .stat-card.primary { background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%); }
        .stat-card.secondary { background: linear-gradient(135deg, var(--secondary-color) 0%, #0056b3 100%); }
        .stat-card.success { background: linear-gradient(135deg, var(--success-color) 0%, #1e7e34 100%); }
        .stat-card.info { background: linear-gradient(135deg, var(--info-color) 0%, #117a8b 100%); }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .stat-number {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color) 0%, #1e7e34 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, var(--info-color) 0%, #117a8b 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, #e0a800 100%);
            color: #212529;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #545b62 100%);
            color: white;
        }

        .search-container {
            position: relative;
            margin-bottom: 25px;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
            font-size: 16px;
        }

        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .employee-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border-top: 4px solid var(--primary-color);
        }

        .employee-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .employee-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .employee-details {
            margin-bottom: 15px;
        }

        .employee-detail {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #6c757d;
            font-size: 13px;
            margin-bottom: 5px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-working {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }

        .status-off {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .sector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .sector-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border-top: 4px solid var(--primary-color);
        }

        .sector-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .sector-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .sector-info h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
        }

        .sector-count {
            font-size: 13px;
            color: #6c757d;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .schedule-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            border-left: 5px solid var(--success-color);
            transition: var(--transition);
        }

        .schedule-card:hover {
            transform: translateX(5px);
        }

        .schedule-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .schedule-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-color);
        }

        .schedule-date {
            font-size: 14px;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .schedule-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: modalSlideUp 0.3s ease-out;
        }

        @keyframes modalSlideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f8f9fa;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6c757d;
            padding: 5px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: #f8f9fa;
            color: var(--danger-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid #f8f9fa;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 600;
            z-index: 1100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            animation: notificationSlide 0.3s ease-out;
        }

        @keyframes notificationSlide {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }

        .notification.success { background: var(--success-color); }
        .notification.error { background: var(--danger-color); }
        .notification.info { background: var(--info-color); }

        .calendar-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            background: none;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            transition: var(--transition);
        }

        .calendar-nav:hover {
            background: var(--primary-color);
            color: white;
        }

        .calendar-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr); 
            gap: 1px;
            background: #e9ecef;
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .calendar-day-header {
            background: var(--light-color);
            padding: 10px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            color: var(--dark-color);
        }

        .calendar-day {
            background: white;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .calendar-day:hover {
            background: rgba(255, 0, 0, 0.1);
        }

        .calendar-day.selected {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .calendar-day.other-month {
            color: #ccc;
        }

        .calendar-day.today {
            background: var(--warning-color);
            color: #212529;
            font-weight: 600;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .empty-state p {
            font-size: 16px;
            line-height: 1.6;
        }

        .reports-placeholder {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 60px 20px;
            text-align: center;
            border: 2px dashed #dee2e6;
        }

        .reports-placeholder i {
            font-size: 48px;
            color: var(--info-color);
            margin-bottom: 20px;
        }

        .reports-placeholder h3 {
            font-size: 24px;
            color: var(--dark-color);
            margin-bottom: 10px;
        }

        .reports-placeholder p {
            color: #6c757d;
            font-size: 16px;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .main-container {
                border-radius: 8px;
            }

            .header {
                padding: 20px;
            }

            .main-title {
                font-size: 24px;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .nav-tab {
                min-width: auto;
                flex: 1;
                font-size: 12px;
                padding: 12px 8px;
            }

            .tab-content {
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                justify-content: center;
            }

            .employee-grid, .sector-grid, .schedule-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 20px;
                padding: 20px;
            }

            .modal-actions {
                flex-direction: column;
            }
        }

        /* Estilos específicos para PDF */
        .pdf-preview-container {
            display: none;
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--box-shadow);
        }

        .pdf-preview-container.show {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        .pdf-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .pdf-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="1" fill="white" opacity="0.1"/><circle cx="10" cy="90" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        .pdf-logo {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .pdf-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .pdf-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .pdf-section {
            margin-bottom: 30px;
        }

        .pdf-section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pdf-employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .pdf-employee-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #dee2e6;
        }

        .pdf-employee-name {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .pdf-employee-details {
            font-size: 12px;
            color: #6c757d;
        }

        .pdf-status-badge {
            display: inline-block;
            margin-top: 8px;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
        }

        .pdf-status-working {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }

        .pdf-status-off {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Cabeçalho -->
        <div class="header">
            <div class="company-logo">
                <i class="fas fa-store"></i>
                FORT ATACADISTA
            </div>
            <h1 class="main-title">GERENCIAMENTO DE ESCALA DA FRENTE DE CAIXA</h1>
            <p class="subtitle">Sistema completo de gestão de funcionários e cronogramas</p>
        </div>

        <!-- Navegação -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                Dashboard
            </button>
            <button class="nav-tab" onclick="showTab('employees')">
                <i class="fas fa-users"></i>
                Funcionários
            </button>
            <button class="nav-tab" onclick="showTab('schedules')">
                <i class="fas fa-calendar-alt"></i>
                Cronogramas
            </button>
            <button class="nav-tab" onclick="showTab('sectors')">
                <i class="fas fa-building"></i>
                Setores
            </button>
            <button class="nav-tab" onclick="showTab('reports')">
                <i class="fas fa-chart-bar"></i>
                Relatórios
            </button>
        </div>

        <!-- Conteúdo das Abas -->
        
        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card primary">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-number" id="totalEmployees">0</div>
                    <div class="stat-label">Total de Funcionários</div>
                </div>
                <div class="stat-card success" onclick="showWorkingTodayDetails()" style="cursor: pointer;">
                    <div class="stat-icon">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-number" id="workingToday">0</div>
                    <div class="stat-label">Trabalhando Hoje</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-number">5</div>
                    <div class="stat-label">Setores Ativos</div>
                </div>
                <div class="stat-card secondary">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-number" id="totalSchedules">0</div>
                    <div class="stat-label">Cronogramas Criados</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="showAddEmployeeModal()">
                    <i class="fas fa-user-plus"></i>
                    Adicionar Funcionário
                </button>
                <button class="btn btn-success" onclick="showCreateScheduleModal()">
                    <i class="fas fa-calendar-plus"></i>
                    Novo Cronograma
                </button>
                <button class="btn btn-info" onclick="exportData()">
                    <i class="fas fa-download"></i>
                    Exportar Dados
                </button>
                <button class="btn btn-warning" onclick="document.getElementById('importFile').click()">
                    <i class="fas fa-upload"></i>
                    Importar Dados
                </button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
            </div>

            <div class="search-container">
                <input type="text" class="search-input" id="dashboardSearch" placeholder="Buscar funcionários..." oninput="filterEmployees()">
                <i class="fas fa-search search-icon"></i>
            </div>

            <div id="dashboardEmployees" class="employee-grid">
                <div class="empty-state">
                    <i class="fas fa-users"></i>
                    <h3>Nenhum funcionário cadastrado</h3>
                    <p>Comece adicionando funcionários ao sistema para gerenciar a escala da frente de caixa.</p>
                </div>
            </div>
        </div>

        <!-- Funcionários -->
        <div id="employees" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="showAddEmployeeModal()">
                    <i class="fas fa-user-plus"></i>
                    Adicionar Funcionário
                </button>
            </div>

            <div class="search-container">
                <input type="text" class="search-input" id="employeeSearch" placeholder="Buscar funcionários..." oninput="filterEmployees()">
                <i class="fas fa-search search-icon"></i>
            </div>

            <div id="employeesList" class="employee-grid">
                <div class="empty-state">
                    <i class="fas fa-user-plus"></i>
                    <h3>Nenhum funcionário cadastrado</h3>
                    <p>Adicione funcionários para começar a gerenciar a escala de trabalho.</p>
                </div>
            </div>
        </div>

        <!-- Cronogramas -->
        <div id="schedules" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-success" onclick="showCreateScheduleModal()">
                    <i class="fas fa-calendar-plus"></i>
                    Novo Cronograma
                </button>
            </div>

            <div id="schedulesList" class="schedule-grid">
                <div class="empty-state">
                    <i class="fas fa-calendar-alt"></i>
                    <h3>Nenhum cronograma criado</h3>
                    <p>Crie cronogramas para organizar a escala de trabalho dos funcionários.</p>
                </div>
            </div>
        </div>

        <!-- Setores -->
        <div id="sectors" class="tab-content">
            <div id="sectorsList" class="sector-grid">
                <!-- Setores serão carregados dinamicamente -->
            </div>
        </div>

        <!-- Relatórios -->
        <div id="reports" class="tab-content">
            <div class="reports-placeholder">
                <i class="fas fa-chart-line"></i>
                <h3>Relatórios</h3>
                <p>Funcionalidade em desenvolvimento...</p>
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Funcionário -->
    <div id="addEmployeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Funcionário</h2>
                <button class="close-btn" onclick="closeModal('addEmployeeModal')">&times;</button>
            </div>
            <form id="addEmployeeForm">
                <div class="form-group">
                    <label class="form-label">Nome Completo</label>
                    <input type="text" class="form-input" id="employeeName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Setor</label>
                    <select class="form-select" id="employeeSector" required>
                        <option value="">Selecione um setor</option>
                        <option value="Caixa">Caixa</option>
                        <option value="Auto Atendimento">Auto Atendimento</option>
                        <option value="Carrinhos">Carrinhos</option>
                        <option value="Assistentes">Assistentes</option>
                        <option value="Fiscal">Fiscal</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Horário de Trabalho</label>
                    <select class="form-select" id="employeeSchedule" required>
                        <option value="">Selecione um horário</option>
                        <option value="06:40-15:00">06:40 - 15:00</option>
                        <option value="08:00-16:20">08:00 - 16:20</option>
                        <option value="10:30-18:50">10:30 - 18:50</option>
                        <option value="13:00-21:20">13:00 - 21:20</option>
                        <option value="14:30-22:50">14:30 - 22:50</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Dia de Folga na Semana</label>
                    <select class="form-select" id="employeeOffDay" required>
                        <option value="">Selecione o dia de folga</option>
                        <option value="segunda">Segunda-feira</option>
                        <option value="terca">Terça-feira</option>
                        <option value="quarta">Quarta-feira</option>
                        <option value="quinta">Quinta-feira</option>
                        <option value="sexta">Sexta-feira</option>
                        <option value="sabado">Sábado</option>
                        <option value="nenhum">Nenhum dia da semana</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ciclo de Folga de Domingo (2026)</label>
                    <select class="form-select" id="employeeSundayCycle">
                        <option value="">Selecione o ciclo</option>
                        <option value="A">Domingo A (Folga: 04/01, 18/01, 01/02...)</option>
                        <option value="B">Domingo B (Folga: 11/01, 25/01, 08/02...)</option>
                        <option value="C">Domingo C (Trabalha todos os domingos)</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addEmployeeModal')">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Trabalhando Hoje -->
    <div id="workingTodayModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="modal-title" id="workingTodayTitle">Funcionários Trabalhando Hoje</h2>
                <button class="close-btn" onclick="closeModal('workingTodayModal')">&times;</button>
            </div>
            <div id="workingTodayList" class="employee-grid">
                <!-- Lista será preenchida via JS -->
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('workingTodayModal')">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal Criar Cronograma -->
    <div id="createScheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Criar Novo Cronograma</h2>
                <button class="close-btn" onclick="closeModal('createScheduleModal')">&times;</button>
            </div>
            <form id="createScheduleForm">
                <div class="form-group">
                    <label class="form-label">Nome do Cronograma</label>
                    <input type="text" class="form-input" id="scheduleName" placeholder="Ex: Escala Setembro 2025" required>
                </div>
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button type="button" class="calendar-nav" onclick="changeMonth(-1)">&lt;</button>
                        <div class="calendar-title" id="calendarTitle"></div>
                        <button type="button" class="calendar-nav" onclick="changeMonth(1)">&gt;</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendário será gerado dinamicamente -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createScheduleModal')">Cancelar</button>
                    <button type="submit" class="btn btn-success">Criar Cronograma</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Visualizar Cronograma -->
    <div id="viewScheduleModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title" id="viewScheduleTitle">Visualizar Cronograma</h2>
                <button class="close-btn" onclick="closeModal('viewScheduleModal')">&times;</button>
            </div>
            <div id="scheduleDetails">
                <!-- Detalhes do cronograma serão carregados aqui -->
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-info" onclick="togglePDFPreview()">
                    <i class="fas fa-file-pdf"></i>
                    <span id="pdfToggleText">Visualizar PDF</span>
                </button>
                <button type="button" class="btn btn-success" onclick="downloadSchedulePDF()">
                    <i class="fas fa-download"></i>
                    Baixar PDF
                </button>
                <button type="button" class="btn btn-secondary" onclick="closeModal('viewScheduleModal')">Fechar</button>
            </div>
            
            <!-- Preview do PDF (escondido por padrão) -->
            <div id="pdfPreviewContainer" class="pdf-preview-container">
                <!-- Conteúdo do preview será gerado aqui -->
            </div>
            
            <!-- Elemento escondido para captura do html2canvas -->
            <div id="pdfCaptureElement" style="position: absolute; left: -9999px; width: 800px; background: white; padding: 40px;">
                <!-- Conteúdo para captura será gerado aqui -->
            </div>
        </div>
    </div>

    <script>
        // Estado da aplicação
        let employees = [];
        let schedules = [];
        let currentDate = new Date();
        let selectedDate = null;
        let pdfPreviewVisible = false;

        const sectors = [
            { name: 'Caixa', color: '#FF0000', icon: 'fas fa-cash-register', description: 'Operação de frente de caixa' },
            { name: 'Auto Atendimento', color: '#28a745', icon: 'fas fa-tools', description: 'Caixas de autoatendimento' },
            { name: 'Carrinhos', color: '#ffc107', icon: 'fas fa-shopping-cart', description: 'Organização de carrinhos' },
            { name: 'Assistentes', color: '#17a2b8', icon: 'fas fa-hands-helping', description: 'Apoio aos clientes e operadores de caixas' },
            { name: 'Gerente', color: '#343a40', icon: 'fas fa-user-shield', description: 'Gerência' }
        ];

        // Inicialização
        window.onload = function() {
            loadData();
            updateStats();
            renderEmployees();
            renderDashboardEmployees();
            renderSchedules();
            renderSectors();
            generateCalendar();
        };

        // Funções de navegação
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // Funções de modal
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            if (modalId === 'createScheduleModal') {
                generateCalendar();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            if (modalId === 'viewScheduleModal') {
                document.getElementById('pdfPreviewContainer').classList.remove('show');
                document.getElementById('pdfToggleText').textContent = 'Visualizar PDF';
                pdfPreviewVisible = false;
            }
        }

        function showAddEmployeeModal() {
            document.getElementById('addEmployeeForm').reset();
            showModal('addEmployeeModal');
        }

        function showCreateScheduleModal() {
            document.getElementById('createScheduleForm').reset();
            selectedDate = null;
            showModal('createScheduleModal');
        }

        // Funções de funcionários
        function addEmployee(event) {
            event.preventDefault();
            
            const name = document.getElementById('employeeName').value.trim();
            const sector = document.getElementById('employeeSector').value;
            const schedule = document.getElementById('employeeSchedule').value;
            const offDay = document.getElementById('employeeOffDay').value;
            const sundayCycle = document.getElementById('employeeSundayCycle').value;
            
            if (!name || !sector || !schedule || !offDay) {
                showNotification('Por favor, preencha todos os campos.', 'error');
                return;
            }
            
            const employee = {
                id: Date.now(),
                name,
                sector,
                schedule,
                offDay,
                sundayCycle: sundayCycle || 'C',
                status: 'Trabalhando',
                createdAt: new Date().toISOString()
            };
            
            employees.push(employee);
            saveData();
            updateStats();
            renderEmployees();
            renderDashboardEmployees();
            closeModal('addEmployeeModal');
            showNotification('Funcionário adicionado com sucesso!', 'success');
        }

        function deleteEmployee(id) {
            if (confirm('Tem certeza que deseja excluir este funcionário?')) {
                employees = employees.filter(employee => employee.id !== id);
                saveData();
                updateStats();
                renderEmployees();
                renderDashboardEmployees();
                showNotification('Funcionário excluído com sucesso!', 'success');
            }
        }

        function renderEmployees() {
            const container = document.getElementById('employeesList');
            renderEmployeeList(container);
        }

        function renderDashboardEmployees() {
            const container = document.getElementById('dashboardEmployees');
            renderEmployeeList(container);
        }

        function renderEmployeeList(container) {
            if (!container) return;
            if (employees.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>Nenhum funcionário cadastrado</h3>
                        <p>Comece adicionando funcionários ao sistema para gerenciar a escala da frente de caixa.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = employees.map(employee => `
                <div class="employee-card">
                    <div class="employee-name">
                        <i class="fas fa-user"></i>
                        ${employee.name}
                        <button onclick="deleteEmployee(${employee.id})" style="margin-left: auto; background: none; border: none; color: #dc3545; cursor: pointer; font-size: 16px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="employee-details">
                        <div class="employee-detail">
                            <i class="fas fa-building"></i>
                            ${employee.sector}
                        </div>
                        <div class="employee-detail">
                            <i class="fas fa-clock"></i>
                            ${employee.schedule}
                        </div>
                        <div class="employee-detail">
                            <i class="fas fa-calendar-times"></i>
                            Folga: ${getOffDayName(employee.offDay)}
                        </div>
                        <div class="employee-detail">
                            <i class="fas fa-sun"></i>
                            Ciclo Domingo: ${employee.sundayCycle || 'C'}
                        </div>
                    </div>
                    <div class="status-badge ${employee.status === 'Trabalhando' ? 'status-working' : 'status-off'}">
                        <i class="fas ${employee.status === 'Trabalhando' ? 'fa-check' : 'fa-times'}"></i>
                        ${employee.status}
                    </div>
                </div>
            `).join('');
        }

        // Funções de setores
        function renderSectors() {
            const container = document.getElementById('sectorsList');
            if (!container) return;
            
            container.innerHTML = sectors.map(sector => {
                const employeeCount = employees.filter(emp => emp.sector === sector.name).length;
                
                return `
                    <div class="sector-card" style="border-top-color: ${sector.color};">
                        <div class="sector-header">
                            <div class="sector-icon" style="background: ${sector.color};">
                                <i class="${sector.icon}"></i>
                            </div>
                            <div class="sector-info">
                                <h3>${sector.name}</h3>
                                <div class="sector-description">${sector.description}</div>
                                <div class="sector-count">${employeeCount} funcionários</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Funções de cronograma
        function createSchedule(event) {
            event.preventDefault();
            
            const name = document.getElementById('scheduleName').value.trim();
            
            if (!name) {
                showNotification('Digite um nome para o cronograma.', 'error');
                return;
            }
            
            if (!selectedDate) {
                showNotification('Selecione uma data para o cronograma.', 'error');
                return;
            }
            
            // Validação adicional para garantir que selectedDate é uma data válida
            if (!(selectedDate instanceof Date) || isNaN(selectedDate.getTime())) {
                showNotification('Data selecionada inválida. Selecione uma data válida.', 'error');
                return;
            }
            
            // Usar exatamente a data selecionada pelo usuário, garantindo que seja apenas a data (sem horário)
            const scheduleDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), selectedDate.getDate(), 0, 0, 0, 0);
            
            const schedule = {
                id: Date.now(),
                name,
                date: scheduleDate.toISOString(), // Armazenar como string ISO para consistência
                dateText: scheduleDate.toLocaleDateString('pt-BR'),
                dayText: scheduleDate.toLocaleDateString('pt-BR', { weekday: 'long' }),
                employees: employees.map(emp => {
                    const dayOfWeek = scheduleDate.getDay();
                    const dayNames = {
                        0: 'domingo',
                        1: 'segunda',
                        2: 'terca',
                        3: 'quarta',
                        4: 'quinta',
                        5: 'sexta',
                        6: 'sabado'
                    };
                    
                    let isOffDay = emp.offDay === dayNames[dayOfWeek];
                    
                    // Lógica especial para domingos em 2026
                    if (dayOfWeek === 0) {
                        // Calcular a diferença de semanas a partir de 04/01/2026 (Referência Ciclo A)
                        const referenceDate = new Date(2026, 0, 4); // 04 de Janeiro de 2026
                        const diffTime = scheduleDate.getTime() - referenceDate.getTime();
                        const diffWeeks = Math.floor(diffTime / (1000 * 60 * 60 * 24 * 7));
                        
                        // Se a diferença de semanas for par (0, 2, 4...), é Ciclo A
                        // Se a diferença de semanas for ímpar (1, 3, 5...), é Ciclo B
                        const isCycleASunday = Math.abs(diffWeeks) % 2 === 0;
                        
                        if (emp.sundayCycle === 'A') {
                            isOffDay = isCycleASunday; // Folga se for domingo de Ciclo A
                        } else if (emp.sundayCycle === 'B') {
                            isOffDay = !isCycleASunday; // Folga se for domingo de Ciclo B
                        } else {
                            isOffDay = false; // Ciclo C trabalha sempre
                        }
                    }
                    
                    return {
                        ...emp,
                        status: isOffDay ? 'FOLGA' : 'Trabalhando'
                    };
                }),
                createdAt: new Date().toISOString()
            };
            
            schedules.push(schedule);
            saveData();
            updateStats();
            renderSchedules();
            closeModal('createScheduleModal');
            showNotification('Cronograma criado com sucesso!', 'success');
        }

        function deleteSchedule(id) {
            if (confirm('Tem certeza que deseja excluir este cronograma?')) {
                schedules = schedules.filter(schedule => schedule.id !== id);
                saveData();
                updateStats();
                renderSchedules();
                showNotification('Cronograma excluído com sucesso!', 'success');
            }
        }

        function viewSchedule(id) {
            const schedule = schedules.find(s => s.id === id);
            if (!schedule) return;
            
            document.getElementById('viewScheduleTitle').textContent = schedule.name;
            
            // Garantir que a data seja processada corretamente
            let displayDate, displayDay;
            
            if (schedule.date) {
                // Se a data está armazenada como string ISO, converter para Date
                const scheduleDate = typeof schedule.date === 'string' ? new Date(schedule.date) : schedule.date;
                displayDate = scheduleDate.toLocaleDateString('pt-BR');
                displayDay = scheduleDate.toLocaleDateString('pt-BR', { weekday: 'long' });
            } else {
                // Fallback para dados antigos
                displayDate = schedule.dateText || 'Data não disponível';
                displayDay = schedule.dayText || 'Dia não disponível';
            }
            
            const detailsContainer = document.getElementById('scheduleDetails');
            detailsContainer.innerHTML = `
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; color: #495057;">
                        <i class="fas fa-calendar"></i> ${displayDate} - ${displayDay}
                    </h4>
                    <p style="color: #6c757d; margin: 0;">
                        <i class="fas fa-clock"></i> Cronograma criado em ${new Date(schedule.createdAt).toLocaleDateString('pt-BR')}
                    </p>
                </div>
                ${renderScheduleEmployees(schedule.employees)}
            `;
            
            showModal('viewScheduleModal');
        }

        function renderScheduleEmployees(employees) {
            const organizedEmployees = organizeScheduleEmployees(employees);
            
            return organizedEmployees.map(sector => `
                <div style="margin-bottom: 25px; background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid ${getSectorColor(sector.name)};">
                    <h4 style="margin-bottom: 15px; color: #495057; display: flex; align-items: center; gap: 10px;">
                        <i class="${getSectorIcon(sector.name)}" style="color: ${getSectorColor(sector.name)};"></i>
                        ${sector.name} (${sector.employees.length} funcionários)
                    </h4>
                    ${sector.schedules.map(scheduleGroup => `
                        <div style="margin-bottom: 15px; background: #f8f9fa; border-radius: 6px; padding: 15px;">
                            <h5 style="margin-bottom: 10px; color: #495057; font-size: 14px;">
                                <i class="fas fa-clock"></i> ${scheduleGroup.schedule} (${scheduleGroup.employees.length} funcionários)
                            </h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">
                                ${scheduleGroup.employees.map(employee => `
                                    <div style="background: white; padding: 10px; border-radius: 4px; border-left: 3px solid ${employee.status === 'FOLGA' ? '#dc3545' : '#28a745'};">
                                        <div style="font-weight: 600; color: #495057; margin-bottom: 5px;">
                                            <i class="fas fa-user"></i> ${employee.name}
                                        </div>
                                        <div style="font-size: 12px; color: #6c757d;">
                                            ${employee.sector} • ${employee.schedule}
                                        </div>
                                        <div style="margin-top: 5px;">
                                            <span style="background: ${employee.status === 'FOLGA' ? '#dc3545' : '#28a745'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                                ${employee.status === 'FOLGA' ? '🏠 FOLGA' : '💼 TRABALHANDO'}
                                            </span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        function organizeScheduleEmployees(employees) {
            const organized = [];
            
            sectors.forEach(sector => {
                const sectorEmployees = employees.filter(emp => emp.sector === sector.name);
                if (sectorEmployees.length === 0) return;
                
                const scheduleGroups = {};
                sectorEmployees.forEach(employee => {
                    if (!scheduleGroups[employee.schedule]) {
                        scheduleGroups[employee.schedule] = [];
                    }
                    scheduleGroups[employee.schedule].push(employee);
                });
                
                const schedulesArr = Object.keys(scheduleGroups).map(schedule => ({
                    schedule,
                    employees: scheduleGroups[schedule]
                }));
                
                organized.push({
                    name: sector.name,
                    employees: sectorEmployees,
                    schedules: schedulesArr
                });
            });
            
            return organized;
        }

        function renderSchedules() {
            const container = document.getElementById('schedulesList');
            if (!container) return;
            
            if (schedules.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>Nenhum cronograma criado</h3>
                        <p>Crie cronogramas para organizar a escala de trabalho dos funcionários.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = schedules.map(schedule => {
                // Garantir que a data seja processada corretamente para exibição
                let displayDate, displayDay;
                
                if (schedule.date) {
                    // Se a data está armazenada como string ISO, converter para Date
                    const scheduleDate = typeof schedule.date === 'string' ? new Date(schedule.date) : schedule.date;
                    displayDate = scheduleDate.toLocaleDateString('pt-BR');
                    displayDay = scheduleDate.toLocaleDateString('pt-BR', { weekday: 'long' });
                } else {
                    // Fallback para dados antigos
                    displayDate = schedule.dateText || 'Data não disponível';
                    displayDay = schedule.dayText || 'Dia não disponível';
                }
                
                return `
                    <div class="schedule-card">
                        <div class="schedule-header">
                            <div>
                                <div class="schedule-title">${schedule.name}</div>
                                <div class="schedule-date">
                                    <i class="fas fa-calendar"></i>
                                    ${displayDate} - ${displayDay}
                                </div>
                                <div class="schedule-meta">
                                    <i class="fas fa-clock"></i>
                                    Criado em ${new Date(schedule.createdAt).toLocaleDateString('pt-BR')}
                                </div>
                            </div>
                        </div>
                        <div class="schedule-actions">
                            <button class="btn btn-sm btn-info" onclick="viewSchedule(${schedule.id})">
                                <i class="fas fa-eye"></i>
                                Visualizar
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="deleteSchedule(${schedule.id})">
                                <i class="fas fa-trash"></i>
                                Excluir
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Funções de calendário
        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            const calendarTitle = document.getElementById('calendarTitle');
            if (calendarTitle) {
                calendarTitle.textContent = 
                    new Date(year, month).toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
            }
            
            const firstDay = new Date(year, month, 1);
            
            const calendarGrid = document.getElementById('calendarGrid');
            if (!calendarGrid) return;
            calendarGrid.innerHTML = '';
            
            // Cabeçalhos dos dias (INCLUINDO DOMINGO)
            const dayHeaders = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Calcular o primeiro dia da semana (domingo = 0)
            let startDate = new Date(firstDay);
            const firstDayOfWeek = firstDay.getDay();
            startDate.setDate(startDate.getDate() - firstDayOfWeek);
            
            // Gerar dias do calendário (6 semanas x 7 dias = 42 células)
            const currentDateObj = new Date(startDate);
            for (let i = 0; i < 42; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = currentDateObj.getDate();
                
                if (currentDateObj.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }
                
                if (currentDateObj.toDateString() === new Date().toDateString()) {
                    dayElement.classList.add('today');
                }
                
                if (selectedDate && currentDateObj.toDateString() === selectedDate.toDateString()) {
                    dayElement.classList.add('selected');
                }
                
                // Capturar a data atual do loop para o evento de clique
                const clickedDate = new Date(currentDateObj.getFullYear(), currentDateObj.getMonth(), currentDateObj.getDate());
                dayElement.addEventListener('click', () => {
                    selectDate(clickedDate);
                });
                
                calendarGrid.appendChild(dayElement);
                currentDateObj.setDate(currentDateObj.getDate() + 1);
            }
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            generateCalendar();
        }

        function selectDate(date) {
            // Garantir que a data seja armazenada sem informações de horário
            selectedDate = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0, 0);
            generateCalendar();
        }

        // Funções de notificação
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Funções auxiliares para setores
        function getSectorColor(sectorName) {
            const sector = sectors.find(s => s.name === sectorName);
            return sector ? sector.color : '#6c757d';
        }

        function getSectorIcon(sectorName) {
            const sector = sectors.find(s => s.name === sectorName);
            return sector ? sector.icon : 'fas fa-building';
        }

        // Event listeners
        document.getElementById('addEmployeeForm').addEventListener('submit', addEmployee);
        document.getElementById('createScheduleForm').addEventListener('submit', createSchedule);

        // Fechar modais ao clicar fora
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                closeModal(event.target.id);
            }
        });

        // FUNÇÃO APRIMORADA: Toggle do preview do PDF
        function togglePDFPreview() {
            const container = document.getElementById('pdfPreviewContainer');
            const toggleText = document.getElementById('pdfToggleText');
            
            if (!pdfPreviewVisible) {
                generatePDFPreview();
                container.classList.add('show');
                toggleText.textContent = 'Ocultar PDF';
                pdfPreviewVisible = true;
            } else {
                container.classList.remove('show');
                toggleText.textContent = 'Visualizar PDF';
                pdfPreviewVisible = false;
            }
        }

        // FUNÇÃO NOVA: Gerar preview do PDF com imagens
        function generatePDFPreview() {
            const scheduleTitle = document.getElementById('viewScheduleTitle').textContent;
            const schedule = schedules.find(s => s.name === scheduleTitle);
            
            if (!schedule) return;

            // Garantir que a data seja processada corretamente
            let displayDate, displayDay;
            
            if (schedule.date) {
                const scheduleDate = typeof schedule.date === 'string' ? new Date(schedule.date) : schedule.date;
                displayDate = scheduleDate.toLocaleDateString('pt-BR');
                displayDay = scheduleDate.toLocaleDateString('pt-BR', { weekday: 'long' });
            } else {
                displayDate = schedule.dateText || 'Data não disponível';
                displayDay = schedule.dayText || 'Dia não disponível';
            }

            const container = document.getElementById('pdfPreviewContainer');
            const organizedEmployees = organizeScheduleEmployees(schedule.employees);
            
            container.innerHTML = `
                <div class="pdf-header">
                    <div class="pdf-logo">
                        <i class="fas fa-store"></i>
                        FORT ATACADISTA
                    </div>
                    <div class="pdf-title">CRONOGRAMA DE ESCALA DA FRENTE DE CAIXA</div>
                    <div class="pdf-subtitle">${displayDate} - ${displayDay}</div>
                </div>
                
                <div class="pdf-section">
                    <div class="pdf-section-title">
                        <i class="fas fa-info-circle"></i>
                        ${schedule.name}
                    </div>
                    <p style="color: #6c757d; margin: 0;">
                        <i class="fas fa-clock"></i> Criado em: ${new Date(schedule.createdAt).toLocaleDateString('pt-BR')}
                    </p>
                </div>
                
                ${organizedEmployees.map(sector => `
                    <div class="pdf-section">
                        <div class="pdf-section-title">
                            <i class="${getSectorIcon(sector.name)}"></i>
                            ${sector.name} (${sector.employees.length} funcionários)
                        </div>
                        ${sector.schedules.map(scheduleGroup => `
                            <div style="margin-bottom: 15px;">
                                <h6 style="margin-bottom: 10px; color: #495057; font-size: 14px; font-weight: 600;">
                                    <i class="fas fa-clock"></i> ${scheduleGroup.schedule} (${scheduleGroup.employees.length} funcionários)
                                </h6>
                                <div class="pdf-employee-grid">
                                    ${scheduleGroup.employees.map(employee => `
                                        <div class="pdf-employee-item">
                                            <div class="pdf-employee-name">
                                                <i class="fas fa-user"></i>
                                                ${employee.name}
                                            </div>
                                            <div class="pdf-employee-details">
                                                <div class="pdf-employee-detail">
                                                    <i class="fas fa-building"></i>
                                                    ${employee.sector}
                                                </div>
                                                <div class="pdf-employee-detail">
                                                    <i class="fas fa-clock"></i>
                                                    ${employee.schedule}
                                                </div>
                                                <div class="pdf-employee-detail">
                                                    <i class="fas fa-calendar-times"></i>
                                                    Folga: ${getOffDayName(employee.offDay)}
                                                </div>
                                            </div>
                                            <div class="pdf-status-badge ${employee.status === 'FOLGA' ? 'pdf-status-off' : 'pdf-status-working'}">
                                                <i class="fas ${employee.status === 'FOLGA' ? 'fa-times' : 'fa-check'}"></i>
                                                ${employee.status === 'FOLGA' ? 'FOLGA' : 'TRABALHANDO'}
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `).join('')}
            `;
        }

        // FUNÇÃO APRIMORADA: Download do PDF com imagens
        function downloadSchedulePDF() {
            const scheduleTitle = document.getElementById('viewScheduleTitle').textContent;
            const schedule = schedules.find(s => s.name === scheduleTitle);
            
            if (!schedule) {
                showNotification('Erro ao encontrar cronograma para exportação.', 'error');
                return;
            }

            try {
                const captureElement = document.getElementById('pdfCaptureElement');
                const organizedEmployees = organizeScheduleEmployees(schedule.employees);
                
                let displayDate, displayDay;
                if (schedule.date) {
                    const scheduleDate = typeof schedule.date === 'string' ? new Date(schedule.date) : schedule.date;
                    displayDate = scheduleDate.toLocaleDateString('pt-BR');
                    displayDay = scheduleDate.toLocaleDateString('pt-BR', { weekday: 'long' });
                } else {
                    displayDate = schedule.dateText || 'Data não disponível';
                    displayDay = schedule.dayText || 'Dia não disponível';
                }
                
                captureElement.innerHTML = `
                    <div style="font-family: 'Inter', Arial, sans-serif; color: #333; line-height: 1.6;">
                        <div style="background: linear-gradient(135deg, #FF0000 0%, #CC0000 100%); color: white; padding: 30px; text-align: center; border-radius: 12px; margin-bottom: 30px;">
                            <div style="background: white; color: #FF0000; padding: 15px 30px; border-radius: 8px; display: inline-block; font-weight: 800; font-size: 18px; margin-bottom: 20px;">
                                🏪 FORT ATACADISTA
                            </div>
                            <h1 style="font-size: 28px; font-weight: 700; margin-bottom: 10px;">CRONOGRAMA DE ESCALA DA FRENTE DE CAIXA</h1>
                            <p style="font-size: 16px; opacity: 0.9;">${displayDate} - ${displayDay}</p>
                        </div>
                        
                        <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 30px; border-left: 4px solid #007bff;">
                            <h2 style="font-size: 20px; font-weight: 600; color: #495057; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                                📋 ${schedule.name}
                            </h2>
                            <p style="color: #6c757d; margin: 0;">
                                🕒 Criado em: ${new Date(schedule.createdAt).toLocaleDateString('pt-BR')}
                            </p>
                        </div>
                        
                        ${organizedEmployees.map(sector => `
                            <div style="background: white; border-radius: 8px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid ${getSectorColor(sector.name)};">
                                <h3 style="font-size: 18px; font-weight: 600; color: #495057; margin-bottom: 20px;">
                                    ${sector.name} (${sector.employees.length} funcionários)
                                </h3>
                                ${sector.schedules.map(scheduleGroup => `
                                    <div style="margin-bottom: 20px; background: #f8f9fa; border-radius: 6px; padding: 15px;">
                                        <h4 style="margin-bottom: 15px; color: #495057; font-size: 16px; font-weight: 600;">
                                            🕒 ${scheduleGroup.schedule} (${scheduleGroup.employees.length} funcionários)
                                        </h4>
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px;">
                                            ${scheduleGroup.employees.map(employee => `
                                                <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid ${employee.status === 'FOLGA' ? '#dc3545' : '#28a745'};">
                                                    <div style="font-weight: 600; color: #495057; margin-bottom: 8px; font-size: 16px;">
                                                        👤 ${employee.name}
                                                    </div>
                                                    <div style="font-size: 14px; color: #6c757d; margin-bottom: 8px;">
                                                        🏢 ${employee.sector} • 🕒 ${employee.schedule}
                                                    </div>
                                                    <div style="font-size: 14px; color: #6c757d; margin-bottom: 10px;">
                                                        📅 Folga: ${getOffDayName(employee.offDay)}
                                                    </div>
                                                    <div style="background: ${employee.status === 'FOLGA' ? '#dc3545' : '#28a745'}; color: white; padding: 6px 12px; border-radius: 15px; font-size: 12px; font-weight: 600; display: inline-block;">
                                                        ${employee.status === 'FOLGA' ? '🏠 FOLGA' : '💼 TRABALHANDO'}
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `).join('')}
                        
                        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px; color: #6c757d; font-size: 12px;">
                            <p>📄 Documento gerado automaticamente pelo Sistema de Gerenciamento de Escala - Fort Atacadista</p>
                            <p>📅 Data de geração: ${new Date().toLocaleDateString('pt-BR')} às ${new Date().toLocaleTimeString('pt-BR')}</p>
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    html2canvas(captureElement, { 
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#ffffff'
                    }).then(canvas => {
                        const { jsPDF } = window.jspdf;
                        const doc = new jsPDF('p', 'mm', 'a4');
                        
                        const imgData = canvas.toDataURL('image/png');
                        const imgWidth = 210;
                        const pageHeight = 295;
                        const imgHeight = (canvas.height * imgWidth) / canvas.width;
                        let heightLeft = imgHeight;
                        let position = 0;
                        
                        doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                        
                        while (heightLeft >= 0) {
                            position = heightLeft - imgHeight;
                            doc.addPage();
                            doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                        }
                        
                        const fileName = `cronograma_${schedule.name.replace(/\s+/g, '_')}_${schedule.dateText.replace(/\//g, '-')}.pdf`;
                        doc.save(fileName);
                        showNotification('PDF gerado com sucesso!', 'success');
                        captureElement.innerHTML = '';
                    }).catch(error => {
                        console.error('Erro ao capturar imagem:', error);
                        showNotification('Erro ao gerar PDF.', 'error');
                    });
                }, 500);
            } catch (error) {
                console.error('Erro ao gerar PDF:', error);
                showNotification('Erro ao gerar PDF.', 'error');
            }
        }

        // Funções auxiliares
        function getOffDayName(offDay) {
            const days = {
                'segunda': 'Segunda-feira',
                'terca': 'Terça-feira',
                'quarta': 'Quarta-feira',
                'quinta': 'Quinta-feira',
                'sexta': 'Sexta-feira',
                'sabado': 'Sábado',
                'nenhum': 'Nenhum dia da semana'
            };
            return days[offDay] || offDay;
        }

        function updateStats() {
            const totalEmployeesEl = document.getElementById('totalEmployees');
            const workingTodayEl = document.getElementById('workingToday');
            const totalSchedulesEl = document.getElementById('totalSchedules');
            
            if (totalEmployeesEl) totalEmployeesEl.textContent = employees.length;
            
            // Calcular quem trabalha hoje baseado na data real
            const today = new Date();
            const workingTodayCount = employees.filter(emp => {
                const dayOfWeek = today.getDay();
                const dayNames = {
                    0: 'domingo', 1: 'segunda', 2: 'terca', 3: 'quarta', 4: 'quinta', 5: 'sexta', 6: 'sabado'
                };
                
                let isOffDay = emp.offDay === dayNames[dayOfWeek];
                
                if (dayOfWeek === 0) {
                    const referenceDate = new Date(2026, 0, 4);
                    const diffTime = today.getTime() - referenceDate.getTime();
                    const diffWeeks = Math.floor(diffTime / (1000 * 60 * 60 * 24 * 7));
                    const isCycleASunday = Math.abs(diffWeeks) % 2 === 0;
                    
                    if (emp.sundayCycle === 'A') isOffDay = isCycleASunday;
                    else if (emp.sundayCycle === 'B') isOffDay = !isCycleASunday;
                    else isOffDay = false;
                }
                return !isOffDay;
            }).length;

            if (workingTodayEl) workingTodayEl.textContent = workingTodayCount;
            if (totalSchedulesEl) totalSchedulesEl.textContent = schedules.length;
        }

        function showWorkingTodayDetails() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            const dayNames = {
                0: 'domingo', 1: 'segunda', 2: 'terca', 3: 'quarta', 4: 'quinta', 5: 'sexta', 6: 'sabado'
            };
            
            const workingEmployees = employees.filter(emp => {
                let isOffDay = emp.offDay === dayNames[dayOfWeek];
                
                if (dayOfWeek === 0) {
                    const referenceDate = new Date(2026, 0, 4);
                    const diffTime = today.getTime() - referenceDate.getTime();
                    const diffWeeks = Math.floor(diffTime / (1000 * 60 * 60 * 24 * 7));
                    const isCycleASunday = Math.abs(diffWeeks) % 2 === 0;
                    
                    if (emp.sundayCycle === 'A') isOffDay = isCycleASunday;
                    else if (emp.sundayCycle === 'B') isOffDay = !isCycleASunday;
                    else isOffDay = false;
                }
                return !isOffDay;
            });

            const container = document.getElementById('workingTodayList');
            const title = document.getElementById('workingTodayTitle');
            
            title.innerHTML = `Trabalhando Hoje (${today.toLocaleDateString('pt-BR')})`;
            
            if (workingEmployees.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; padding: 20px;">Ninguém escalado para hoje.</p>';
            } else {
                container.innerHTML = workingEmployees.map(employee => `
                    <div class="employee-card">
                        <div class="employee-name">
                            <i class="fas fa-user"></i>
                            ${employee.name}
                        </div>
                        <div class="employee-details">
                            <div class="employee-detail">
                                <i class="fas fa-building"></i>
                                ${employee.sector}
                            </div>
                            <div class="employee-detail">
                                <i class="fas fa-clock"></i>
                                ${employee.schedule}
                            </div>
                        </div>
                        <div class="status-badge status-working">
                            <i class="fas fa-check"></i>
                            Trabalhando
                        </div>
                    </div>
                `).join('');
            }
            
            showModal('workingTodayModal');
        }

        function filterEmployees() {
            const searchTerm = (document.getElementById('dashboardSearch')?.value || document.getElementById('employeeSearch')?.value || '').toLowerCase();
            const cards = document.querySelectorAll('.employee-card');

            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }

        // Funções de dados
        function saveData() {
            localStorage.setItem('fortAtacadistaEmployees', JSON.stringify(employees));
            localStorage.setItem('fortAtacadistaSchedules', JSON.stringify(schedules));
        }

        function loadData() {
            const savedEmployees = localStorage.getItem('fortAtacadistaEmployees');
            const savedSchedules = localStorage.getItem('fortAtacadistaSchedules');
            
            if (savedEmployees) employees = JSON.parse(savedEmployees);
            if (savedSchedules) schedules = JSON.parse(savedSchedules);
        }

        function exportData() {
            const data = {
                employees: employees,
                schedules: schedules,
                exportDate: new Date().toISOString()
            };
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `fort_atacadista_backup_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            showNotification('Dados exportados!', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.employees) employees = data.employees;
                    if (data.schedules) schedules = data.schedules;
                    saveData();
                    updateStats();
                    renderEmployees();
                    renderDashboardEmployees();
                    renderSchedules();
                    showNotification('Dados importados!', 'success');
                } catch (error) {
                    showNotification('Erro na importação!', 'error');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }
    </script>
</body>
</html>
Explicar
Sugestões de melhoria para este site? - Manus
